import decimal
from pwn import remote
def partial():
    global c_of_2
    c = 0x5f416d2f80ffc3d2b1104f96779f3ef744a702d8d46c29cf7a848740bc1274ff5391f59a24df240d6f7ff2a5dd3a62680b0ecac10bd22eff0665accd73f99ed180512083fc19165cd6f9b193912914d17c483c7af7c0218d8d953dda00374e950ab93b025c8fc6dd5b03ea12dda74b3275ce1a0ebdc58614c06239b920df914db74070c555a8d59bb7d864bf39d049e67affe871a0d0d01b7eb6a016529e51cf6e7071080367ea53b3bbe75f1990fe73902e6faf314945ce4b695c94225c7aea9dfd9c2f5061dc9960bf5ca7853685e4fbfbdc3fe716cc32e0cf8b12f6c12d7551cfb1c1bdb406b61e69e6c026c10854d63d32d177558cb6742c13559362b53f
    e = 65537
    n =     0xD03B6884F948D3EDDC3A3E729C2D2B4F6525A7D88A54D81C646B833CC2C36663C185FE8A5B53DD3EC9966CF224C2F0409FF4B827255C4D8E80E30BA67BF2627E5A7688F1D4E7FCF607BB85AC9E1C53626E4F2CB4CBA9B8D95181F9003A0113E950377999B83C4FCA1D58753A3B042C96B928003FAF8CBCE72A16D044BE95BD04922CC20D4BD4099DE7B2A8AD5A75AD90D3A3A98638DCFF0A3B631FE7C84A404B9C9D5FD7425658FD85FDA2E5E653D99797253F5BFB666483928D94B80D29C429A330E2321E5C3BD344BE1A95F5CF63F25D9EA71AA22A89FBDA9CB12849B3EA98F43B99D07185C88A59F95E588EE8F9C0BC465AFDBBFC3B38CB77AF9E370E6437
    k = n.bit_length()
    decimal.getcontext().prec = k
    lower = 0
    upper = n
    c_of_2 = pow(2, e, n)
    c = (c * c_of_2 *pow(2,e,n)) % n
    for i in range(k):
        possible_plaintext = (lower + upper) / 2
        r = remote('vps1.blue-whale.me',30006)
        r.recvuntil('Your ciphertext(hex):\n')
        r.sendline(hex(c)[2:])
        if 'even' in r.recvline(keepends=False):
            upper = possible_plaintext
        else:
            lower = possible_plaintext
        c = (c * c_of_2) % n
        print(i, upper, lower)
        r.close()
    return(int(upper))
print(partial())
#48964032763509384060673856084068198110012917711942402559437725335282274561123015832932979266950364649398172259533302799154149930597052768319871764358921183048891506942422487006194492387531264524998564135508899307381443205066880418986978028699524922512010498329523401714963964956651023339276449768824061438822248064542275772534306828603061432968616544145233536997005205696349153722330771782901894810722394506027071955095822066006119945466852437483067783137127959134624059004665691298226842217177121208216408132399698832282705580233686778686096367809500177535903580904619945594891457675035425502352978845077800

